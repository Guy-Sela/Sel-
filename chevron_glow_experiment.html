<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Chevron Glow Experiment</title>
    <style>
        body {
            background-color: #1a1a1a;
            /* Dark background to see the glow */
            color: #ccc;
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px;
        }

        canvas {
            border: 1px solid #333;
            background: #000;
            /* Pure black frame */
            margin-bottom: 20px;
            cursor: crosshair;
        }

        .controls {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            width: 300px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-size: 12px;
        }

        input[type="range"] {
            width: 100%;
        }

        input[type="color"] {
            width: 100%;
            height: 30px;
            border: none;
        }
    </style>
</head>

<body>

    <canvas id="canvas" width="512" height="512"></canvas>

    <div class="controls">
        <div>
            <label>Glow Blur (Size)</label>
            <input type="range" id="blur" min="0" max="500" value="100">
        </div>
        <div>
            <label>Intensity (Stacking)</label>
            <input type="range" id="intensity" min="1" max="20" value="5">
        </div>
        <div>
            <label>Glow Color</label>
            <input type="color" id="color" value="#FFD700">
        </div>
        <div style="grid-column: span 2">
            <label>Glow Opacity</label>
            <input type="range" id="opacity" min="0" max="1" step="0.05" value="0.5">
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const pathString = "M985 711 440 0H57L602 711L57 1421H440Z";
        const chevronPath = new Path2D(pathString);

        // Zapf Dingbats U+276F original bounding box is roughly 0,0 to 985,1421
        // We need to scale and center it in 512x512
        const origW = 1000; // approx
        const origH = 1421;

        function draw() {
            const blur = document.getElementById('blur').value;
            const intensity = document.getElementById('intensity').value;
            const color = document.getElementById('color').value;
            const opacity = document.getElementById('opacity').value;

            // Clear
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // --- 1. Draw Glow (Screen Space, radial gradient) ---
            // Use a true radial gradient so blur == radius; use lighter blending to keep it bright.
            ctx.save();
            ctx.translate(canvas.width / 2, canvas.height / 2);
            ctx.globalCompositeOperation = 'lighter';

            const blurPx = parseFloat(blur);
            const passes = parseInt(intensity, 10);
            const coreR = 40; // visible core radius
            const outerR = Math.max(coreR + 10, blurPx); // let blur slider drive the halo size
            const [r, g, b] = hexToRgb(color).split(',').map(Number);

            for (let i = 0; i < passes; i++) {
                const grad = ctx.createRadialGradient(0, 0, 0, 0, 0, outerR);
                grad.addColorStop(0, `rgba(${r}, ${g}, ${b}, ${opacity})`);
                grad.addColorStop(coreR / outerR, `rgba(${r}, ${g}, ${b}, ${opacity})`);
                grad.addColorStop(1, `rgba(${r}, ${g}, ${b}, 0)`);
                ctx.fillStyle = grad;
                ctx.beginPath();
                ctx.arc(0, 0, outerR, 0, Math.PI * 2);
                ctx.fill();
            }
            ctx.restore();

            // --- 2. Draw Chevron (Transformed Space) ---
            ctx.save();
            const scale = 250 / origH;
            ctx.translate(canvas.width / 2, canvas.height / 2);
            ctx.scale(scale, -scale); // Flip Y
            ctx.translate(-521, -710.5); // Center the glyph geometry

            ctx.shadowColor = "transparent";
            ctx.shadowBlur = 0;
            ctx.fillStyle = "white";
            ctx.fill(chevronPath);
            ctx.restore();
        }

        // Helper
        function hexToRgb(hex) {
            const bigint = parseInt(hex.slice(1), 16);
            const r = (bigint >> 16) & 255;
            const g = (bigint >> 8) & 255;
            const b = bigint & 255;
            return `${r}, ${g}, ${b}`;
        }

        // Listeners
        document.querySelectorAll('input').forEach(el => el.addEventListener('input', draw));

        // Init
        draw();
    </script>
</body>

</html>